{"Name":"Whois","Description":"Query WHOIS servers for domain registration information.  Supports IP Addresses, URLs, Email, Domains.  Supports creation of DOMAIN entities linked to target entity and a domain age threshold to set the entity to suspicious. ","Script":"from SiemplifyAction import SiemplifyAction\nfrom SiemplifyUtils import unix_now, convert_unixtime_to_datetime, output_handler\nfrom SiemplifyUtils import get_domain_from_entity,convert_dict_to_json_result_dict, dict_to_flat, add_prefix_to_dict\nfrom ScriptResult import EXECUTION_STATE_COMPLETED, EXECUTION_STATE_FAILED,EXECUTION_STATE_TIMEDOUT\nimport whois_alt\nfrom tldextract import extract\nimport json\nfrom ipwhois import IPWhois\nimport re\nEXTEND_GRAPH_URL = '{}/external/v1/investigator/ExtendCaseGraph'\n\nfrom datetime import date, datetime\n\ndef create_entity_with_relation(siemplify, new_entity, linked_entity):\n        json_payload = {\n            \"caseId\": siemplify.case_id,\n            \"alertIdentifier\": siemplify.alert_id,\n            \"entityType\": \"DOMAIN\",\n            \"isPrimaryLink\": False,\n            \"isDirectional\": False,\n            \"typesToConnect\": [],\n            \"entityToConnectRegEx\": \"{}$\".format(re.escape(linked_entity)),\n            \"entityIdentifier\": new_entity\n        }\n        payload = json_payload.copy()\n        created_entity = siemplify.session.post(EXTEND_GRAPH_URL.format(siemplify.API_ROOT), json=json_payload)\n        created_entity.raise_for_status()\n        \ndef get_alert_entities(siemplify):\n        return [entity for alert in siemplify.case.alerts for entity in alert.entities]        \n\n \ndef get_domain_from_string(identifier):\n    reg = extract(identifier.lower())\n    return reg.registered_domain\n    \n    \ndef json_serial(obj):\n    \"\"\"JSON serializer for objects not serializable by default json code\"\"\"\n\n    if isinstance(obj, (datetime, date)):\n        return obj.isoformat()\n    raise TypeError (\"Type %s not serializable\" % type(obj))\n    \n    \n\n@output_handler\ndef main():\n    siemplify = SiemplifyAction()\n    \n    status = EXECUTION_STATE_COMPLETED  # used to flag back to siemplify system, the action final status\n    output_message = \"\"  # human readable message, showed in UI as the action result\n    result_value = None  # Set a simple result value, used for playbook if\\else and placeholders.\n    siemplify.script_name = \"Whois\"\n    create_entities = siemplify.extract_action_param(\"Create Entities\", print_value=True).lower() == \"true\"\n    age_threshold = siemplify.extract_action_param(\"Domain Age Threshold\", print_value=True, default_value=0, input_type=int)\n    json_result = {}\n    updated_entities = []\n    enriched_entities = {}\n    for entity in siemplify.target_entities:\n        print(entity)\n        if entity.entity_type == \"ADDRESS\":\n            print(entity.identifier)\n            try:\n                obj = IPWhois(entity.identifier)\n                obj.lookup_rdap(depth=1)\n                json_result[entity.identifier] = obj.lookup_rdap(depth=1)\n                result_value = \"true\"\n            except Exception as e:\n                print(e)\n                pass\n        else:\n            try:\n                domain = get_domain_from_string(entity.identifier)\n                if domain:\n                    whois_data = whois_alt.get_whois(domain)\n                    if 'creation_date' in whois_data:\n                        whois_data['age_in_days'] = int((datetime.now() - whois_data['creation_date'][0]).total_seconds() / 86400)\n                    json_result[entity.identifier] = json.loads(json.dumps(whois_data, default=json_serial))\n                    del whois_data['raw']\n                    enriched_entities[entity.identifier] = json.loads(json.dumps(whois_data, default=json_serial))\n                    result_value = \"true\"\n                    if create_entities:\n                        create_entity_with_relation(siemplify, domain, entity.identifier)\n                        enriched_entities[domain] = json.loads(json.dumps(whois_data, default=json_serial))\n                        json_result[domain] = json.loads(json.dumps(whois_data, default=json_serial))\n                \n            except whois_alt.shared.WhoisException as e:\n                pass\n        \n    if enriched_entities:\n        siemplify.load_case_data()\n        alert_entities = get_alert_entities(siemplify)\n        for new_entity in enriched_entities:\n            for entity in alert_entities:\n                if new_entity.strip() == entity.identifier.strip():\n                    entity.additional_properties.update(add_prefix_to_dict(dict_to_flat(enriched_entities[new_entity]), \"WHOIS\"))\n                    if ('age_in_days' in enriched_entities[new_entity] \n                        and enriched_entities[new_entity]['age_in_days'] < int(age_threshold) \n                        and int(age_threshold) != 0):\n                            if create_entities and entity.entity_type == \"DOMAIN\":\n                                entity.is_suspicious = True\n                                \n                            elif not create_entities:\n                                entity.is_suspicious = True\n                                siemplify.LOGGER.info(f\"Marking {entity.identifier} as suspicious\")\n                    entity.is_enriched = True\n                    updated_entities.append(entity)\n                    break\n        siemplify.LOGGER.info(f\"updating entities: {updated_entities}\")\n        siemplify.update_entities(updated_entities)\n        output_message += \"Enriched the following entities {}\".format(updated_entities)\n            \n\n    return_json = json.dumps(json_result, default=json_serial)\n    siemplify.result.add_result_json(convert_dict_to_json_result_dict(return_json))\n    \n    siemplify.LOGGER.info(\"\\n  status: {}\\n  result_value: {}\\n  output_message: {}\".format(status,result_value, output_message))\n    siemplify.end(output_message, result_value, status)\n\n\nif __name__ == \"__main__\":\n    main()","IntegrationIdentifier":"Enrichment","ScriptResultName":"ScriptResult","DynamicResultsMetadata":[{"ResultName":"JsonResult","ResultExample":"[\r\n\t{\r\n\t\t\"Entity\": \"outlook.com\",\r\n\t\t\"EntityResult\": {\r\n\t\t\t\"id\": [\r\n\t\t\t\t\"2019401_DOMAIN_COM-VRSN\"\r\n\t\t\t],\r\n\t\t\t\"status\": [\r\n\t\t\t\t\"clientDeleteProhibited https://icann.org/epp#clientDeleteProhibited\",\r\n\t\t\t\t\"clientTransferProhibited https://icann.org/epp#clientTransferProhibited\",\r\n\t\t\t\t\"clientUpdateProhibited https://icann.org/epp#clientUpdateProhibited\",\r\n\t\t\t\t\"serverDeleteProhibited https://icann.org/epp#serverDeleteProhibited\",\r\n\t\t\t\t\"serverTransferProhibited https://icann.org/epp#serverTransferProhibited\",\r\n\t\t\t\t\"serverUpdateProhibited https://icann.org/epp#serverUpdateProhibited\"\r\n\t\t\t],\r\n\t\t\t\"creation_date\": [\r\n\t\t\t\t\"1994-08-18T04:00:00\"\r\n\t\t\t],\r\n\t\t\t\"expiration_date\": [\r\n\t\t\t\t\"2022-08-17T04:00:00\"\r\n\t\t\t],\r\n\t\t\t\"updated_date\": [\r\n\t\t\t\t\"2021-07-16T09:32:12\"\r\n\t\t\t],\r\n\t\t\t\"registrar\": [\r\n\t\t\t\t\"MarkMonitor Inc.\"\r\n\t\t\t],\r\n\t\t\t\"whois_server\": [\r\n\t\t\t\t\"whois.markmonitor.com\"\r\n\t\t\t],\r\n\t\t\t\"nameservers\": [\r\n\t\t\t\t\"NS1-38.AZURE-DNS.COM\",\r\n\t\t\t\t\"NS2-38.AZURE-DNS.NET\",\r\n\t\t\t\t\"NS3-38.AZURE-DNS.ORG\",\r\n\t\t\t\t\"NS4-38.AZURE-DNS.INFO\",\r\n\t\t\t\t\"NSE12.O365FILTERING.COM\",\r\n\t\t\t\t\"NSE13.O365FILTERING.COM\",\r\n\t\t\t\t\"NSE21.O365FILTERING.COM\",\r\n\t\t\t\t\"NSE24.O365FILTERING.COM\"\r\n\t\t\t],\r\n\t\t\t\"emails\": [\r\n\t\t\t\t\"abusecomplaints@markmonitor.com\"\r\n\t\t\t],\r\n\t\t\t\"contacts\": {\r\n\t\t\t\t\"registrant\": null,\r\n\t\t\t\t\"tech\": null,\r\n\t\t\t\t\"admin\": null,\r\n\t\t\t\t\"billing\": null\r\n\t\t\t},\r\n\t\t\t\"age_in_days\": 9987\r\n\t\t}\r\n\t},\r\n\t{\r\n\t\t\"Entity\": \"104.198.157.10\",\r\n\t\t\"EntityResult\": {\r\n\t\t\t\"nir\": null,\r\n\t\t\t\"asn_registry\": \"arin\",\r\n\t\t\t\"asn\": \"15169\",\r\n\t\t\t\"asn_cidr\": \"104.198.128.0/19\",\r\n\t\t\t\"asn_country_code\": \"US\",\r\n\t\t\t\"asn_date\": \"2014-08-27\",\r\n\t\t\t\"asn_description\": \"GOOGLE, US\",\r\n\t\t\t\"query\": \"104.198.157.10\",\r\n\t\t\t\"network\": {\r\n\t\t\t\t\"handle\": \"NET-104-196-0-0-1\",\r\n\t\t\t\t\"status\": [\r\n\t\t\t\t\t\"active\"\r\n\t\t\t\t],\r\n\t\t\t\t\"remarks\": [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t\"title\": \"Registration Comments\",\r\n\t\t\t\t\t\t\"description\": \"** The IP addresses under this netblock are in use by Google Cloud customers ** \\r\\n\\r\\nDirect all copyright and legal complaints to \\r\\nhttps://support.google.com/legal/go/report\\r\\n\\r\\nDirect all spam and abuse complaints to \\r\\nhttps://support.google.com/code/go/gce_abuse_report\\r\\n\\r\\nFor fastest response, use the relevant forms above.\\r\\n\\r\\nComplaints can also be sent to the GC Abuse desk \\r\\n(google-cloud-compliance@google.com) \\r\\nbut may have longer turnaround times.\\r\\n\\r\\nComplaints sent to any other POC will be ignored.\",\r\n\t\t\t\t\t\t\"links\": null\r\n\t\t\t\t\t}\r\n\t\t\t\t],\r\n\t\t\t\t\"notices\": [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t\"title\": \"Terms of Service\",\r\n\t\t\t\t\t\t\"description\": \"By using the ARIN RDAP/Whois service, you are agreeing to the RDAP/Whois Terms of Use\",\r\n\t\t\t\t\t\t\"links\": [\r\n\t\t\t\t\t\t\t\"https://www.arin.net/resources/registry/whois/tou/\"\r\n\t\t\t\t\t\t]\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t\"title\": \"Whois Inaccuracy Reporting\",\r\n\t\t\t\t\t\t\"description\": \"If you see inaccuracies in the results, please visit: \",\r\n\t\t\t\t\t\t\"links\": [\r\n\t\t\t\t\t\t\t\"https://www.arin.net/resources/registry/whois/inaccuracy_reporting/\"\r\n\t\t\t\t\t\t]\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t\"title\": \"Copyright Notice\",\r\n\t\t\t\t\t\t\"description\": \"Copyright 1997-2021, American Registry for Internet Numbers, Ltd.\",\r\n\t\t\t\t\t\t\"links\": null\r\n\t\t\t\t\t}\r\n\t\t\t\t],\r\n\t\t\t\t\"links\": [\r\n\t\t\t\t\t\"https://rdap.arin.net/registry/ip/104.196.0.0\",\r\n\t\t\t\t\t\"https://whois.arin.net/rest/net/NET-104-196-0-0-1\"\r\n\t\t\t\t],\r\n\t\t\t\t\"events\": [\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t\"action\": \"last changed\",\r\n\t\t\t\t\t\t\"timestamp\": \"2015-09-21T20:50:14-04:00\",\r\n\t\t\t\t\t\t\"actor\": null\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t\"action\": \"registration\",\r\n\t\t\t\t\t\t\"timestamp\": \"2014-08-27T13:55:35-04:00\",\r\n\t\t\t\t\t\t\"actor\": null\r\n\t\t\t\t\t}\r\n\t\t\t\t],\r\n\t\t\t\t\"raw\": null,\r\n\t\t\t\t\"start_address\": \"104.196.0.0\",\r\n\t\t\t\t\"end_address\": \"104.199.255.255\",\r\n\t\t\t\t\"cidr\": \"104.196.0.0/14\",\r\n\t\t\t\t\"ip_version\": \"v4\",\r\n\t\t\t\t\"type\": \"DIRECT ALLOCATION\",\r\n\t\t\t\t\"name\": \"GOOGLE-CLOUD\",\r\n\t\t\t\t\"country\": null,\r\n\t\t\t\t\"parent_handle\": \"NET-104-0-0-0-0\"\r\n\t\t\t},\r\n\t\t\t\"entities\": [\r\n\t\t\t\t\"GOOGL-2\"\r\n\t\t\t],\r\n\t\t\t\"objects\": {\r\n\t\t\t\t\"GOOGL-2\": {\r\n\t\t\t\t\t\"handle\": \"GOOGL-2\",\r\n\t\t\t\t\t\"status\": null,\r\n\t\t\t\t\t\"remarks\": [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\"title\": \"Registration Comments\",\r\n\t\t\t\t\t\t\t\"description\": \"*** The IP addresses under this Org-ID are in use by Google Cloud customers *** \\r\\n\\r\\nDirect all copyright and legal complaints to \\r\\nhttps://support.google.com/legal/go/report\\r\\n\\r\\nDirect all spam and abuse complaints to \\r\\nhttps://support.google.com/code/go/gce_abuse_report\\r\\n\\r\\nFor fastest response, use the relevant forms above.\\r\\n\\r\\nComplaints can also be sent to the GC Abuse desk \\r\\n(google-cloud-compliance@google.com) \\r\\nbut may have longer turnaround times.\\r\\n\\r\\nComplaints sent to any other POC will be ignored.\",\r\n\t\t\t\t\t\t\t\"links\": null\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t],\r\n\t\t\t\t\t\"notices\": null,\r\n\t\t\t\t\t\"links\": [\r\n\t\t\t\t\t\t\"https://rdap.arin.net/registry/entity/GOOGL-2\",\r\n\t\t\t\t\t\t\"https://whois.arin.net/rest/org/GOOGL-2\"\r\n\t\t\t\t\t],\r\n\t\t\t\t\t\"events\": [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\"action\": \"last changed\",\r\n\t\t\t\t\t\t\t\"timestamp\": \"2019-11-01T05:34:25-04:00\",\r\n\t\t\t\t\t\t\t\"actor\": null\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\"action\": \"registration\",\r\n\t\t\t\t\t\t\t\"timestamp\": \"2006-09-29T16:40:11-04:00\",\r\n\t\t\t\t\t\t\t\"actor\": null\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t],\r\n\t\t\t\t\t\"raw\": null,\r\n\t\t\t\t\t\"roles\": [\r\n\t\t\t\t\t\t\"registrant\"\r\n\t\t\t\t\t],\r\n\t\t\t\t\t\"contact\": {\r\n\t\t\t\t\t\t\"name\": \"Google LLC\",\r\n\t\t\t\t\t\t\"kind\": \"org\",\r\n\t\t\t\t\t\t\"address\": [\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\"type\": null,\r\n\t\t\t\t\t\t\t\t\"value\": \"1600 Amphitheatre Parkway\\nMountain View\\nCA\\n94043\\nUnited States\"\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\"phone\": null,\r\n\t\t\t\t\t\t\"email\": null,\r\n\t\t\t\t\t\t\"role\": null,\r\n\t\t\t\t\t\t\"title\": null\r\n\t\t\t\t\t},\r\n\t\t\t\t\t\"events_actor\": null,\r\n\t\t\t\t\t\"entities\": [\r\n\t\t\t\t\t\t\"GCABU-ARIN\",\r\n\t\t\t\t\t\t\"ZG39-ARIN\"\r\n\t\t\t\t\t]\r\n\t\t\t\t},\r\n\t\t\t\t\"GCABU-ARIN\": {\r\n\t\t\t\t\t\"handle\": \"GCABU-ARIN\",\r\n\t\t\t\t\t\"status\": [\r\n\t\t\t\t\t\t\"validated\"\r\n\t\t\t\t\t],\r\n\t\t\t\t\t\"remarks\": null,\r\n\t\t\t\t\t\"notices\": [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\"title\": \"Terms of Service\",\r\n\t\t\t\t\t\t\t\"description\": \"By using the ARIN RDAP/Whois service, you are agreeing to the RDAP/Whois Terms of Use\",\r\n\t\t\t\t\t\t\t\"links\": [\r\n\t\t\t\t\t\t\t\t\"https://www.arin.net/resources/registry/whois/tou/\"\r\n\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\"title\": \"Whois Inaccuracy Reporting\",\r\n\t\t\t\t\t\t\t\"description\": \"If you see inaccuracies in the results, please visit: \",\r\n\t\t\t\t\t\t\t\"links\": [\r\n\t\t\t\t\t\t\t\t\"https://www.arin.net/resources/registry/whois/inaccuracy_reporting/\"\r\n\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\"title\": \"Copyright Notice\",\r\n\t\t\t\t\t\t\t\"description\": \"Copyright 1997-2021, American Registry for Internet Numbers, Ltd.\",\r\n\t\t\t\t\t\t\t\"links\": null\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t],\r\n\t\t\t\t\t\"links\": [\r\n\t\t\t\t\t\t\"https://rdap.arin.net/registry/entity/GCABU-ARIN\",\r\n\t\t\t\t\t\t\"https://whois.arin.net/rest/poc/GCABU-ARIN\"\r\n\t\t\t\t\t],\r\n\t\t\t\t\t\"events\": [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\"action\": \"last changed\",\r\n\t\t\t\t\t\t\t\"timestamp\": \"2021-04-09T11:46:04-04:00\",\r\n\t\t\t\t\t\t\t\"actor\": null\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\"action\": \"registration\",\r\n\t\t\t\t\t\t\t\"timestamp\": \"2011-03-30T00:36:28-04:00\",\r\n\t\t\t\t\t\t\t\"actor\": null\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t],\r\n\t\t\t\t\t\"raw\": null,\r\n\t\t\t\t\t\"roles\": [\r\n\t\t\t\t\t\t\"abuse\",\r\n\t\t\t\t\t\t\"noc\"\r\n\t\t\t\t\t],\r\n\t\t\t\t\t\"contact\": {\r\n\t\t\t\t\t\t\"name\": \"GC Abuse\",\r\n\t\t\t\t\t\t\"kind\": \"group\",\r\n\t\t\t\t\t\t\"address\": [\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\"type\": null,\r\n\t\t\t\t\t\t\t\t\"value\": \"1600 Amphitheatre Parkway\\nMountain View\\nCA\\n94043\\nUnited States\"\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\"phone\": [\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\"type\": [\r\n\t\t\t\t\t\t\t\t\t\"work\",\r\n\t\t\t\t\t\t\t\t\t\"voice\"\r\n\t\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t\t\"value\": \"+1-650-253-0000\"\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\"email\": [\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\"type\": null,\r\n\t\t\t\t\t\t\t\t\"value\": \"google-cloud-compliance@google.com\"\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\"role\": null,\r\n\t\t\t\t\t\t\"title\": null\r\n\t\t\t\t\t},\r\n\t\t\t\t\t\"events_actor\": null,\r\n\t\t\t\t\t\"entities\": null\r\n\t\t\t\t},\r\n\t\t\t\t\"ZG39-ARIN\": {\r\n\t\t\t\t\t\"handle\": \"ZG39-ARIN\",\r\n\t\t\t\t\t\"status\": [\r\n\t\t\t\t\t\t\"validated\"\r\n\t\t\t\t\t],\r\n\t\t\t\t\t\"remarks\": null,\r\n\t\t\t\t\t\"notices\": [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\"title\": \"Terms of Service\",\r\n\t\t\t\t\t\t\t\"description\": \"By using the ARIN RDAP/Whois service, you are agreeing to the RDAP/Whois Terms of Use\",\r\n\t\t\t\t\t\t\t\"links\": [\r\n\t\t\t\t\t\t\t\t\"https://www.arin.net/resources/registry/whois/tou/\"\r\n\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\"title\": \"Whois Inaccuracy Reporting\",\r\n\t\t\t\t\t\t\t\"description\": \"If you see inaccuracies in the results, please visit: \",\r\n\t\t\t\t\t\t\t\"links\": [\r\n\t\t\t\t\t\t\t\t\"https://www.arin.net/resources/registry/whois/inaccuracy_reporting/\"\r\n\t\t\t\t\t\t\t]\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\"title\": \"Copyright Notice\",\r\n\t\t\t\t\t\t\t\"description\": \"Copyright 1997-2021, American Registry for Internet Numbers, Ltd.\",\r\n\t\t\t\t\t\t\t\"links\": null\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t],\r\n\t\t\t\t\t\"links\": [\r\n\t\t\t\t\t\t\"https://rdap.arin.net/registry/entity/ZG39-ARIN\",\r\n\t\t\t\t\t\t\"https://whois.arin.net/rest/poc/ZG39-ARIN\"\r\n\t\t\t\t\t],\r\n\t\t\t\t\t\"events\": [\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\"action\": \"last changed\",\r\n\t\t\t\t\t\t\t\"timestamp\": \"2021-11-10T10:26:54-05:00\",\r\n\t\t\t\t\t\t\t\"actor\": null\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\"action\": \"registration\",\r\n\t\t\t\t\t\t\t\"timestamp\": \"2000-11-30T13:54:08-05:00\",\r\n\t\t\t\t\t\t\t\"actor\": null\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t],\r\n\t\t\t\t\t\"raw\": null,\r\n\t\t\t\t\t\"roles\": [\r\n\t\t\t\t\t\t\"administrative\",\r\n\t\t\t\t\t\t\"technical\"\r\n\t\t\t\t\t],\r\n\t\t\t\t\t\"contact\": {\r\n\t\t\t\t\t\t\"name\": \"Google LLC\",\r\n\t\t\t\t\t\t\"kind\": \"group\",\r\n\t\t\t\t\t\t\"address\": [\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\"type\": null,\r\n\t\t\t\t\t\t\t\t\"value\": \"1600 Amphitheatre Parkway\\nMountain View\\nCA\\n94043\\nUnited States\"\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\"phone\": [\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\"type\": [\r\n\t\t\t\t\t\t\t\t\t\"work\",\r\n\t\t\t\t\t\t\t\t\t\"voice\"\r\n\t\t\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\t\t\"value\": \"+1-650-253-0000\"\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\"email\": [\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\"type\": null,\r\n\t\t\t\t\t\t\t\t\"value\": \"arin-contact@google.com\"\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t\t\"role\": null,\r\n\t\t\t\t\t\t\"title\": null\r\n\t\t\t\t\t},\r\n\t\t\t\t\t\"events_actor\": null,\r\n\t\t\t\t\t\"entities\": null\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t\"raw\": null\r\n\t\t}\r\n\t}\r\n]","ShowResult":true}],"Creator":"admin","IsEnabled":true,"IsCustom":false,"IsSystem":false,"IsImported":false,"Version":18.0,"TimeoutSeconds":300,"IsAsync":false,"AsyncPollingIntervalInSeconds":30,"TotalIntervalTimeoutForAsyncInSeconds":86400,"Parameters":[{"CustomActionId":0,"IsMandatory":false,"DefaultValue":"true","Description":"Create and link domain entities to URL and Email / User names.","Name":"Create Entities","Value":"true","Type":1,"OptionalValues":null,"OptionalValuesJson":null},{"CustomActionId":0,"IsMandatory":false,"DefaultValue":"","Description":"Domains who's age is less than the than the supplied days will be marked suspicious.  ","Name":"Domain Age Threshold","Value":"","Type":0,"OptionalValues":null,"OptionalValuesJson":null}],"DefaultResultValue":"","PythonVersion":"None","SimulationData":{"Entities":null},"SimulationDataJson":null}